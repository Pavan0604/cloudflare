name: Test-Github

run-name: Testing

on:
    push:
        branches:
          "*"

jobs:
    Test-github:
        runs-on: "ubuntu-latest"
        steps:
        - name: get logical id of the launch template 
          id: get-logical-id
          run: |
            template_id=$(aws cloudformation describe-stack-resource --stack-name=test3  --logical-resource-id=GithubActionsLaunchTemplate --region=ap-south-1 --query='StackResourceDetail.PhysicalResourceId')
            aws ec2 run-instances --launch-template LaunchTemplateId=${template_id},Version=$Latest --region=ap-south-1
          env:
            AWS_ACCESS_KEY_ID: ${{ secrets.AWS_ACCESS_KEY_ID }}
            AWS_SECRET_ACCESS_KEY: ${{ secrets.AWS_SECRET_ACCESS_KEY }}